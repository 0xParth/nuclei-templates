id: linux-enum

info:
  name: Services Which are Running as Root
  author: pussycat0x
  severity: info
  description: |
    Linux Enumeration for Privilege Escalation.
  reference:
    - https://github.com/rebootuser/LinEnum
  tags: code,linux,privesc,enum

self-contained: true
code:
  - engine:
      - sh
      - bash
    source: |
      whoami

  - engine:
      - sh
      - bash
    source: |
        (cat /proc/version || uname -a ) 2>/dev/null

  - engine:
      - sh
      - bash
    source: |
       id


    extractors:
      - type: dsl
        name : currenr_user
        dsl:
          - code_1_response

      - type: dsl
        name : kernel_info
        dsl:
          - code_2_response
# digest: 4a0a00473045022055f05ad021713dd212dece14232549b8d6a3e66539f2d443ff105af359175f03022100b225145ef72917705adef084ec712560879eb0dfb542483d546f375944c0d3aa:c8251d2f4b494560fa261588bedfe7b7
